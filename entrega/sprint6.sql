/*Sprint 6*/


/* PRIMERA PROBLEMATICA */

/*Crear en la base de datos los tipos de cliente, de cuenta y marcas de
tarjeta. Insertar los valores según la información provista en el Sprint 5*/

create table "Tipo de cliente"("id" INTEGER primary key, "Tipo" varchar(20) not null)

create table "Tipo de cuenta"("id" INTEGER primary key, "Tipo" varchar(20) not null)

create table "Marcas de tarjeta"("id" INTEGER primary key, "Marca" varchar(30) not null)


insert into "Tipo de cliente" values(1,"Classic"),(2,"Gold"),(3,"Black")

insert into "Tipo de cuenta" values(1,"Caja de ahorro en pesos"),(2,"Caja de ahorro en dólares"),(3,"Cuenta corriente")

insert into "Marcas de tarjeta" values(1,"VISA"),(2,"Mastercard"),(3,"American Express")


select * from "Tipo de cliente"
select * from "Tipo de cuenta"
select * from "Marcas de tarjeta"

/*Agregar la entidad tarjeta teniendo en cuenta los atributos necesarios para la operación del home banking (se sugieren los
siguientes campos Numero (único e irrepetible, con una restricción ante cada inserción que no debe superar 20 números/espacios), CVV,
Fecha de otorgamiento, Fecha Expiración). Almacenar si es una tarjeta de crédito o débito. Relacionar las tarjetas con la tabla donde se guardan las marcas de
tarjeta. Relacionar las tarjetas con el cliente al que pertenecen */

create table "Tarjeta"("id" INTEGER primary key, "Número" int UNIQUE CHECK (length("Número")<20), "CVV" int, "Fecha de otorgamiento" text, "Fecha de expiración" text, "Tipo de tarjeta" varchar(10), "Marcas de tarjetas", "Cliente", FOREIGN KEY("Marcas de tarjetas") REFERENCES "Marcas de tarjeta"("id"), FOREIGN KEY("Cliente") REFERENCES cliente(customer_id))
select * from "Tarjeta"


/* Insertar 500 tarjetas de crédito con sus respectivos datos(www.generatedata.com) asociándolas a los clientes de formaaleatoria */

INSERT INTO "Tarjeta"
VALUES
  (1,38874162058259304,367,"25/21/2009","27/14/2022","débito",2,86),
  (2,89664430774615280,527,"22/38/2001","14/37/2019","débito",2,332),
  (3,42617034652635030,541,"12/52/2011","15/58/2021","crédito",2,37),
  (4,86051781239235060,920,"13/51/2004","14/08/2018","crédito",1,112),
  (5,93277113271333840,284,"20/00/2009","08/34/2023","débito",3,41),
  (6,17460462869287264,646,"09/02/2005","10/32/2022","débito",3,297),
  (7,79281405900873760,807,"31/49/2003","03/11/2022","crédito",3,169),
  (8,25899292571044256,523,"11/05/2007","10/56/2020","crédito",3,267),
  (9,5755889299778596,809,"31/07/2009","02/32/2013","débito",2,406),
  (10,18174864938219490,789,"30/07/2010","15/17/2012","débito",2,321),
  (11,21714542895157732,162,"30/29/2002","01/59/2012","crédito",2,285),
  (12,21410131843941816,709,"19/01/2008","30/41/2020","crédito",1,90),
  (13,1692866820441634,408,"22/23/2003","16/07/2018","débito",3,301),
  (14,31083847283536330,764,"20/48/2010","17/42/2015","débito",2,95),
  (15,82959677534501260,274,"20/17/2006","21/59/2020","crédito",1,260),
  (16,54453881259593640,616,"28/21/2003","02/34/2017","crédito",1,398),
  (17,71741334297011990,424,"02/24/2002","11/39/2014","débito",2,378),
  (18,80737813888945820,797,"05/19/2003","12/20/2019","débito",2,422),
  (19,84287107871060320,278,"16/13/2005","04/22/2014","crédito",2,78),
  (20,57753291295154136,695,"17/58/2011","21/04/2020","crédito",2,275),
  (21,61034374294096700,312,"26/28/2002","04/37/2015","débito",2,68),
  (22,46635733477154940,976,"14/15/2002","12/49/2021","débito",2,450),
  (23,79422071479790420,687,"26/35/2003","09/19/2012","crédito",1,196),
  (24,73309840219958580,608,"24/30/2004","07/24/2015","crédito",2,357),
  (25,48576302205291624,183,"01/33/2008","11/49/2018","débito",2,107),
  (26,59529537041459070,477,"19/52/2007","17/03/2022","débito",1,192),
  (27,6831903870024370,731,"06/00/2007","08/46/2014","crédito",2,179),
  (28,94856060586607300,916,"20/28/2008","07/16/2020","crédito",3,297),
  (29,56599631215503580,715,"27/32/2001","24/15/2023","débito",2,324),
  (30,91624895199872860,547,"09/44/2009","12/32/2019","débito",1,106),
  (31,44871586601989680,279,"07/49/2006","29/51/2018","crédito",2,457),
  (32,16407714803484364,676,"20/45/2002","27/55/2014","crédito",3,489),
  (33,60878136847871100,152,"11/00/2004","25/31/2016","débito",1,338),
  (34,91519267609757550,932,"30/33/2001","22/27/2022","débito",2,437),
  (35,7609112456951014,848,"01/07/2001","15/47/2019","crédito",2,432),
  (36,41585300682310220,706,"04/45/2002","21/42/2014","crédito",2,313),
  (37,39932651092719416,525,"23/05/2011","12/06/2012","débito",2,383),
  (38,45741548243357610,211,"28/02/2010","08/51/2018","débito",3,285),
  (39,28219908194248532,431,"25/36/2004","17/16/2016","crédito",2,147),
  (40,87857945106746020,657,"17/06/2002","04/59/2013","crédito",2,453),
  (41,50586260558763530,911,"31/13/2010","07/37/2021","débito",2,401),
  (42,84632766533934130,109,"26/57/2000","27/15/2019","débito",2,328),
  (43,69287091529938770,872,"21/57/2005","16/34/2022","crédito",2,320),
  (44,97703314279599280,464,"28/08/2007","04/44/2023","crédito",2,275),
  (45,31190355418953316,805,"06/09/2009","02/18/2016","débito",1,344),
  (46,71939771330547850,657,"18/32/2007","02/06/2016","débito",2,160),
  (47,93299751559610740,882,"26/13/2010","23/30/2019","crédito",2,244),
  (48,24085171768983940,885,"07/07/2009","15/35/2014","crédito",1,412),
  (49,41396999777392850,758,"27/10/2011","27/30/2018","débito",2,3),
  (50,7919198940165141,493,"16/07/2000","05/03/2013","débito",1,469);
  
INSERT INTO "Tarjeta"
VALUES
  (51,12141302982313800,297,"23/08/2004","26/22/2020","crédito",2,334),
  (52,22936202395513748,355,"10/31/2008","23/21/2016","crédito",3,291),
  (53,15899829640892400,618,"06/31/2011","05/29/2021","débito",2,180),
  (54,46056379917655900,882,"11/36/2004","22/31/2014","débito",3,357),
  (55,23066990643672040,693,"19/31/2005","08/06/2016","crédito",1,486),
  (56,80138241702194110,423,"14/43/2003","11/12/2022","crédito",3,402),
  (57,54351337429872640,789,"09/31/2005","31/13/2020","débito",1,354),
  (58,37660354673998020,615,"29/13/2001","27/01/2019","débito",2,148),
  (59,77426854025204860,989,"22/53/2004","05/53/2017","crédito",2,436),
  (60,88710446086969440,945,"16/38/2004","20/28/2016","crédito",2,192),
  (61,33087468796640030,709,"28/55/2007","24/34/2015","débito",1,379),
  (62,96572660903402980,312,"15/11/2003","23/17/2023","débito",2,176),
  (63,195951741468522,297,"22/18/2004","09/41/2019","crédito",2,127),
  (64,43511553937507280,235,"15/24/2011","06/23/2016","crédito",3,138),
  (65,89197636728986700,867,"31/56/2006","09/12/2013","débito",2,118),
  (66,83866849368820110,182,"02/54/2004","26/17/2019","débito",2,247),
  (67,3311099997954441,957,"14/14/2008","18/06/2021","crédito",3,472),
  (68,55382979631640490,741,"02/32/2007","20/14/2013","crédito",2,25),
  (69,1355621415887325,422,"02/26/2000","17/44/2014","débito",2,413),
  (70,91673989749442100,649,"17/58/2001","17/58/2023","débito",2,178),
  (71,19509683440573388,102,"21/03/2010","13/54/2023","crédito",2,465),
  (72,87443900727886020,383,"29/02/2010","22/27/2023","crédito",1,392),
  (73,38444511935797530,494,"20/28/2005","27/35/2019","débito",1,489),
  (74,53488529180750440,310,"11/13/2010","28/15/2014","débito",1,248),
  (75,25783719140926644,381,"15/43/2006","06/51/2015","crédito",2,120),
  (76,63263494181939736,122,"24/50/2004","20/49/2017","crédito",3,433),
  (77,34891338361753720,319,"23/08/2007","16/13/2019","débito",3,202),
  (78,82596490609038030,291,"26/54/2008","11/41/2017","débito",2,215),
  (79,7731778488721891,482,"31/55/2007","22/32/2018","crédito",1,328),
  (80,3509117007710750,379,"29/59/2005","14/16/2021","crédito",1,172),
  (81,40950556001709000,268,"17/33/2008","26/29/2017","débito",2,450),
  (82,41391674727613256,374,"01/27/2011","30/18/2013","débito",2,146),
  (83,55696566631006570,234,"28/48/2003","29/35/2016","crédito",2,402),
  (84,89619829004272930,849,"07/29/2003","04/01/2020","crédito",3,222),
  (85,49077461931713040,677,"12/08/2001","03/14/2019","débito",2,477),
  (86,83487370434641950,942,"19/45/2004","31/11/2018","débito",2,115),
  (87,99463753986303890,817,"18/40/2003","24/26/2016","crédito",1,147),
  (88,94693697613578110,617,"20/34/2009","27/47/2022","crédito",2,192),
  (89,54933483367306260,536,"21/05/2009","17/00/2018","débito",1,330),
  (90,55465359945933600,502,"01/50/2011","11/13/2019","débito",1,332),
  (91,33137230401887724,274,"24/29/2001","28/25/2019","crédito",1,42),
  (92,18007170842400104,895,"25/41/2010","29/02/2022","crédito",1,339),
  (93,87784815733074900,745,"29/59/2007","16/26/2022","débito",1,92),
  (94,67894345082055340,761,"27/33/2000","14/38/2019","débito",3,160),
  (95,28429539899353990,472,"29/52/2004","12/24/2012","crédito",1,53),
  (96,51817972507903384,624,"07/39/2005","11/35/2023","crédito",2,285),
  (97,23062951530894652,635,"04/10/2010","03/51/2014","débito",3,259),
  (98,79022848575106340,382,"25/11/2010","17/06/2013","débito",2,53),
  (99,34559252924729572,745,"10/06/2000","10/02/2016","crédito",1,163),
  (100,44798284042163000,740,"23/48/2003","29/12/2020","crédito",2,143);
  
INSERT INTO "Tarjeta"
VALUES
  (101,29804621514312668,680,"16/31/2007","26/09/2014","débito",2,472),
  (102,22345518459018492,466,"26/43/2001","10/46/2016","débito",3,94),
  (103,34973667247239396,884,"12/58/2008","27/09/2020","crédito",1,197),
  (104,51496300811905030,845,"06/34/2005","23/19/2015","crédito",2,385),
  (105,83610448900776340,688,"21/12/2000","21/31/2014","débito",3,141),
  (106,49088942707390290,231,"22/23/2000","18/29/2013","débito",1,258),
  (107,41262449705805200,209,"20/45/2003","06/16/2012","crédito",2,134),
  (108,79827226275170300,217,"17/46/2010","08/26/2019","crédito",2,314),
  (109,43890568885677720,968,"29/53/2002","16/55/2013","débito",3,453),
  (110,46974230302706024,656,"27/00/2010","29/14/2021","débito",3,170),
  (111,6889070134460475,708,"02/03/2001","08/31/2016","crédito",2,125),
  (112,55011778359726610,928,"19/00/2001","30/15/2014","crédito",1,142),
  (113,77213629500668300,632,"26/25/2001","22/23/2015","débito",1,327),
  (114,85310648658763500,344,"30/04/2001","08/02/2013","débito",3,180),
  (115,8906398406746223,913,"06/16/2011","15/00/2015","crédito",1,327),
  (116,90459530719995490,115,"23/55/2003","25/45/2015","crédito",1,473),
  (117,85863699475177970,280,"05/44/2003","02/35/2013","débito",3,320),
  (118,5175194318858342,510,"02/15/2009","19/58/2013","débito",2,226),
  (119,45691727078799140,596,"19/27/2008","27/59/2015","crédito",2,206),
  (120,30396532914567830,523,"29/58/2002","05/44/2016","crédito",2,211),
  (121,58734492442430590,424,"24/47/2007","27/14/2013","débito",3,131),
  (122,78499576464442600,406,"10/04/2006","04/10/2018","débito",2,460),
  (123,74900049186564240,940,"20/15/2008","11/12/2016","crédito",3,250),
  (124,91325222076061700,995,"13/56/2002","07/20/2020","crédito",3,482),
  (125,59660422781864310,197,"05/37/2005","29/19/2012","débito",1,232),
  (126,42413360978193940,939,"14/47/2005","25/09/2015","débito",3,297),
  (127,55935347318252320,800,"13/32/2011","26/15/2016","crédito",1,2),
  (128,77770680867453040,779,"21/30/2005","01/28/2015","crédito",2,190),
  (129,83800738482275790,845,"20/30/2002","01/44/2015","débito",3,25),
  (130,53857707028282520,188,"05/47/2001","26/45/2016","débito",2,49),
  (131,6519416644480945,250,"06/34/2006","14/55/2015","crédito",3,96),
  (132,72127590417530690,916,"22/37/2001","14/33/2015","crédito",2,465),
  (133,18818563472411132,491,"04/22/2006","27/47/2015","débito",3,287),
  (134,86986950066071520,747,"05/36/2000","10/22/2012","débito",2,23),
  (135,65302424558035176,382,"17/41/2003","22/55/2016","crédito",3,183),
  (136,2201745658377716,367,"06/18/2002","03/11/2018","crédito",3,203),
  (137,33718710754747084,407,"30/06/2004","31/23/2015","débito",1,465),
  (138,19571369117244332,971,"05/28/2004","04/52/2019","débito",2,474),
  (139,23735325428538096,236,"27/17/2005","03/28/2016","crédito",2,36),
  (140,75585101239729440,472,"12/32/2005","25/17/2022","crédito",2,229),
  (141,48191307630756900,463,"26/52/2002","28/56/2020","débito",2,140),
  (142,51985038588583784,388,"05/48/2010","06/56/2017","débito",2,419),
  (143,74774230752389090,462,"02/57/2009","07/45/2013","crédito",2,407),
  (144,92877966745948050,591,"09/15/2001","28/58/2022","crédito",2,480),
  (145,75246473525816080,384,"13/33/2004","22/39/2022","débito",2,64),
  (146,26993219537718108,909,"29/36/2007","22/17/2021","débito",1,374),
  (147,6808077127991155,944,"09/06/2003","27/42/2014","crédito",2,75),
  (148,38204953189664344,154,"14/49/2008","20/27/2014","crédito",1,88),
  (149,97437727406332300,391,"26/55/2010","20/10/2013","débito",3,402),
  (150,87239556133925200,815,"20/08/2002","30/43/2017","débito",2,85);
  
INSERT INTO "Tarjeta"
VALUES
  (151,80381178677673870,296,"17/50/2002","15/22/2021","crédito",3,223),
  (152,96023217017772580,863,"20/34/2004","09/21/2020","crédito",3,231),
  (153,5151117363957849,929,"25/13/2009","14/56/2023","débito",3,188),
  (154,69020099356172740,769,"06/51/2001","06/08/2018","débito",1,493),
  (155,59744056727577920,668,"13/01/2006","17/35/2019","crédito",1,366),
  (156,48807603993278720,341,"13/56/2004","17/14/2015","crédito",2,148),
  (157,66138552599416090,831,"23/20/2006","02/31/2021","débito",1,370),
  (158,16132234273333060,355,"08/25/2008","24/00/2019","débito",2,433),
  (159,21371422042079616,921,"27/30/2004","18/44/2015","crédito",3,223),
  (160,5131314162608712,687,"19/48/2002","19/07/2015","crédito",3,82),
  (161,21470875637801988,212,"08/03/2003","05/11/2023","débito",1,391),
  (162,96909291544183140,825,"09/37/2009","16/03/2016","débito",1,458),
  (163,85742693098267550,108,"27/18/2009","12/41/2021","crédito",1,56),
  (164,59260470901524060,805,"16/00/2003","23/18/2019","crédito",1,47),
  (165,39194622800441890,567,"03/21/2002","08/41/2013","débito",1,389),
  (166,53618561938253864,436,"29/06/2007","03/41/2019","débito",2,96),
  (167,30255527499651852,668,"23/12/2006","28/50/2022","crédito",2,71),
  (168,4837359664395492,349,"27/20/2001","18/12/2013","crédito",2,477),
  (169,83187953919882420,448,"15/06/2006","23/46/2018","débito",2,217),
  (170,30779026760422740,830,"13/44/2003","17/20/2023","débito",2,458),
  (171,33578212482797810,235,"19/50/2000","22/57/2018","crédito",2,440),
  (172,78871472635685760,363,"03/47/2007","05/49/2017","crédito",2,238),
  (173,60485179780971144,158,"24/07/2006","16/58/2016","débito",1,95),
  (174,37561992299447090,500,"05/57/2004","18/45/2022","débito",2,120),
  (175,56551890999215500,194,"24/41/2009","11/50/2018","crédito",2,490),
  (176,43031664438540170,420,"19/30/2008","13/38/2021","crédito",1,462),
  (177,17982426982104408,719,"05/35/2002","29/16/2018","débito",1,156),
  (178,99263696670035310,341,"05/43/2005","07/05/2013","débito",2,383),
  (179,63092220027948824,422,"14/00/2004","22/48/2013","crédito",3,7),
  (180,90299412823884910,567,"22/13/2003","09/14/2022","crédito",2,236),
  (181,22782076753387024,325,"13/23/2002","09/11/2020","débito",2,65),
  (182,5514482065290975,302,"22/24/2009","14/11/2015","débito",1,486),
  (183,78034299472680450,559,"29/36/2008","01/13/2012","crédito",1,399),
  (184,80254485114956130,587,"05/02/2008","12/30/2017","crédito",1,174),
  (185,13295651254637244,452,"20/50/2004","08/35/2022","débito",2,206),
  (186,17565430912081924,791,"27/07/2008","02/10/2018","débito",2,394),
  (187,10806511797862672,934,"19/19/2004","12/06/2014","crédito",2,192),
  (188,80880945007480510,360,"30/12/2003","31/59/2015","crédito",2,300),
  (189,96593797319408540,798,"24/13/2006","17/26/2017","débito",2,313),
  (190,9861906655492388,838,"29/03/2010","06/34/2020","débito",1,119),
  (191,80819194706325180,428,"10/22/2008","03/43/2018","crédito",1,68),
  (192,406348343669308,374,"05/47/2010","06/30/2021","crédito",2,449),
  (193,33114769761029544,527,"25/32/2002","18/45/2015","débito",3,57),
  (194,291067352464286,690,"26/57/2003","19/03/2012","débito",2,336),
  (195,84931044729890030,977,"22/06/2008","15/18/2017","crédito",2,23),
  (196,15159803426128580,723,"24/03/2008","02/00/2018","crédito",2,202),
  (197,61796874125135130,629,"06/21/2001","12/19/2018","débito",1,223),
  (198,77640583485253840,297,"14/19/2004","21/57/2014","débito",2,53),
  (199,67609320635714136,995,"05/11/2010","08/17/2012","crédito",2,205),
  (200,70745863123041910,819,"29/46/2002","06/35/2015","crédito",3,293);

INSERT INTO "Tarjeta"
VALUES
  (201,3993594540458055,235,"30/35/2009","14/53/2023","débito",3,147),
  (202,42319121693128700,124,"24/16/2008","04/54/2021","débito",2,173),
  (203,88660003905988270,533,"03/15/2006","25/52/2016","crédito",3,400),
  (204,51004704694177870,424,"27/18/2001","28/59/2018","crédito",1,280),
  (205,40388790681099600,467,"05/03/2004","16/35/2017","débito",2,453),
  (206,66412810032086440,717,"04/22/2000","02/24/2020","débito",2,228),
  (207,29042955486516004,121,"14/27/2010","22/35/2018","crédito",2,164),
  (208,30997247959906200,370,"21/34/2002","09/58/2018","crédito",2,448),
  (209,66649122726096560,880,"04/00/2006","26/14/2017","débito",1,438),
  (210,99431788327769730,337,"30/25/2001","07/58/2013","débito",1,315),
  (211,38745373299537570,337,"07/35/2004","28/01/2020","crédito",1,62),
  (212,53650766886943870,802,"10/03/2010","28/34/2012","crédito",3,462),
  (213,59322778836717500,908,"14/17/2009","04/28/2013","débito",2,499),
  (214,46733854396863496,686,"10/03/2007","13/43/2017","débito",2,207),
  (215,7589481139283153,322,"19/24/2009","24/06/2017","crédito",2,385),
  (216,25358181976700828,607,"26/04/2011","18/57/2020","crédito",3,247),
  (217,25607961950460576,775,"03/28/2005","16/57/2013","débito",1,418),
  (218,91047416636784400,831,"29/33/2010","04/44/2021","débito",3,411),
  (219,44762880207022660,799,"20/32/2007","23/45/2020","crédito",3,378),
  (220,74290733801931970,934,"16/15/2006","07/46/2016","crédito",2,416),
  (221,28621934037807270,453,"29/19/2001","07/22/2017","débito",2,472),
  (222,56482067441963050,828,"07/19/2002","27/25/2022","débito",3,106),
  (223,84054744834467500,447,"08/03/2004","11/39/2016","crédito",2,229),
  (224,17963407796281204,756,"30/57/2005","20/05/2019","crédito",1,364),
  (225,84633063927865800,987,"22/32/2011","19/41/2016","débito",1,150),
  (226,46481527045670664,684,"09/22/2005","17/05/2017","débito",2,44),
  (227,48977246954617510,414,"23/37/2002","10/49/2017","crédito",2,477),
  (228,28807547551283252,933,"23/15/2007","06/52/2019","crédito",3,250),
  (229,76796089191309460,148,"11/36/2004","12/17/2013","débito",1,476),
  (230,92332542446415950,588,"18/23/2007","30/28/2019","débito",2,430),
  (231,25212027472855976,317,"14/45/2008","28/07/2016","crédito",1,340),
  (232,40649300583274460,147,"11/00/2008","25/42/2018","crédito",2,321),
  (233,96092118831783280,285,"19/38/2010","17/23/2013","débito",3,459),
  (234,42219902314559544,701,"24/37/2006","21/21/2016","débito",2,406),
  (235,5027929072545002,179,"03/39/2010","29/45/2013","crédito",1,407),
  (236,91508153226238140,990,"24/35/2009","09/16/2016","crédito",3,31),
  (237,34777502462385652,269,"29/22/2000","14/46/2017","débito",1,336),
  (238,23741520370679300,975,"26/07/2005","18/07/2014","débito",2,246),
  (239,20607298621328576,857,"04/41/2011","19/00/2013","crédito",3,9),
  (240,63676816631130510,820,"26/48/2008","03/24/2013","crédito",2,98),
  (241,41313995712841590,466,"03/46/2010","04/33/2012","débito",2,324),
  (242,56913296791751030,912,"14/12/2002","19/05/2020","débito",1,137),
  (243,78820504142743020,600,"13/57/2006","07/05/2022","crédito",2,494),
  (244,55321738769517450,874,"14/17/2011","26/14/2015","crédito",3,201),
  (245,3872198432436985,464,"14/23/2002","22/11/2021","débito",2,269),
  (246,50864867041523410,316,"13/53/2009","22/28/2018","débito",2,67),
  (247,54053047525432456,974,"06/39/2008","10/49/2017","crédito",2,446),
  (248,17224740922541304,570,"15/18/2007","26/50/2017","crédito",1,481),
  (249,73256494100674050,466,"30/33/2009","03/04/2021","débito",3,22),
  (250,6687764773438654,627,"29/15/2000","15/52/2021","débito",1,392);

INSERT INTO "Tarjeta"
VALUES
  (251,63382686902447810,639,"06/51/2009","19/41/2022","crédito",1,429),
  (252,84708430808888030,224,"29/07/2007","10/48/2015","crédito",3,347),
  (253,69372852445146760,763,"13/17/2001","24/52/2017","débito",2,332),
  (254,49027237362442360,498,"05/48/2002","28/53/2021","débito",3,425),
  (255,59938781875332070,351,"22/29/2006","24/06/2022","crédito",2,457),
  (256,4402169269529287,450,"13/45/2010","02/19/2017","crédito",3,373),
  (257,6086475676105423,356,"07/06/2005","22/53/2022","débito",1,292),
  (258,82805886202363870,618,"02/49/2009","03/09/2015","débito",1,236),
  (259,8657937842311917,179,"17/27/2008","24/18/2020","crédito",2,360),
  (260,30993804128462930,998,"03/35/2006","23/33/2015","crédito",1,406),
  (261,85186387620940340,462,"14/59/2009","19/08/2013","débito",1,95),
  (262,1533917324028720,846,"21/11/2008","13/21/2016","débito",3,38),
  (263,12434764122532496,790,"05/26/2002","27/51/2022","crédito",1,455),
  (264,69379992010463040,608,"14/09/2006","31/27/2020","crédito",2,253),
  (265,43490307954269850,827,"10/18/2008","29/12/2014","débito",3,139),
  (266,10414671759865416,653,"17/08/2005","11/18/2017","débito",3,22),
  (267,73731043957756220,475,"09/15/2009","05/13/2018","crédito",1,445),
  (268,80404968231087890,438,"15/45/2011","15/36/2016","crédito",3,201),
  (269,4375780518712463,574,"27/02/2006","15/54/2013","débito",1,83),
  (270,3361734973599040,811,"18/55/2004","17/48/2022","débito",2,127),
  (271,54110706512144830,835,"04/43/2002","31/26/2018","crédito",1,170),
  (272,9216172053931652,841,"15/45/2006","24/06/2016","crédito",2,172),
  (273,8616981271527263,237,"31/55/2008","24/28/2016","débito",2,488),
  (274,88637311145987780,903,"21/50/2003","05/21/2022","débito",3,365),
  (275,23235586912153320,775,"30/57/2008","14/27/2014","crédito",2,98),
  (276,46343693191014080,664,"14/40/2004","06/07/2013","crédito",3,138),
  (277,94562304400813620,530,"30/46/2008","28/39/2016","débito",2,90),
  (278,39950684021729950,296,"19/36/2011","05/55/2019","débito",2,64),
  (279,23498467957017996,313,"23/24/2011","15/36/2018","crédito",2,7),
  (280,83016774738329490,946,"21/28/2009","05/41/2018","crédito",1,72),
  (281,57407665047885176,490,"27/15/2003","22/29/2016","débito",3,366),
  (282,43704809819095270,970,"27/32/2004","16/14/2023","débito",2,101),
  (283,25274998885563676,312,"08/03/2008","25/21/2019","crédito",2,128),
  (284,17902242725945888,151,"08/40/2008","20/49/2022","crédito",1,449),
  (285,59983462929354790,345,"12/27/2005","22/52/2016","débito",2,3),
  (286,80145905383448530,579,"06/57/2004","24/37/2021","débito",3,319),
  (287,90292916641256820,906,"19/32/2005","28/39/2013","crédito",2,328),
  (288,61995419590240480,669,"19/40/2007","07/53/2019","crédito",1,258),
  (289,16711371073339112,397,"19/03/2002","30/34/2014","débito",2,103),
  (290,5232489737844186,900,"13/07/2007","10/20/2022","débito",1,342),
  (291,58277994398198030,205,"19/00/2004","25/53/2022","crédito",2,29),
  (292,4889808180906813,703,"05/01/2003","19/34/2020","crédito",1,307),
  (293,33664500326459508,466,"07/47/2010","01/48/2016","débito",2,3),
  (294,50049355101008930,365,"02/12/2005","08/23/2022","débito",2,135),
  (295,63886247412808640,890,"31/29/2005","11/18/2023","crédito",2,146),
  (296,16970978085002132,666,"27/42/2000","09/03/2013","crédito",3,160),
  (297,51499541624945540,762,"27/46/2001","28/36/2020","débito",2,5),
  (298,39458166933925864,139,"11/34/2005","04/17/2015","débito",2,287),
  (299,89251286324890960,559,"21/04/2007","12/10/2023","crédito",1,367),
  (300,22847962985617930,382,"04/04/2007","18/57/2023","crédito",2,221);

INSERT INTO "Tarjeta"
VALUES
  (301,36818585494151650,188,"22/48/2011","02/43/2018","débito",2,176),
  (302,21031555936285292,369,"15/21/2007","31/42/2016","débito",2,167),
  (303,70811184407859850,291,"17/47/2010","13/59/2019","crédito",1,80),
  (304,39554345627541630,604,"20/43/2009","25/13/2013","crédito",2,453),
  (305,23284217208981656,818,"06/31/2003","22/29/2014","débito",1,47),
  (306,37885917856506670,290,"06/26/2010","28/59/2019","débito",1,213),
  (307,48663150204237650,727,"13/43/2009","03/12/2015","crédito",2,409),
  (308,85622416027972960,405,"25/04/2010","07/13/2022","crédito",3,15),
  (309,4665578260765315,637,"29/24/2007","13/49/2015","débito",1,142),
  (310,56571384213752120,364,"22/15/2000","26/22/2016","débito",3,368),
  (311,48928495528423200,528,"26/36/2001","10/23/2020","crédito",1,33),
  (312,80544406729059180,851,"12/23/2010","07/48/2016","crédito",2,228),
  (313,18461904985288100,864,"13/20/2007","31/55/2015","débito",2,113),
  (314,92861701392214620,843,"19/25/2002","17/21/2022","débito",2,334),
  (315,332689229734241,872,"07/22/2011","12/18/2022","crédito",1,413),
  (316,12488319339345708,913,"13/43/2009","26/31/2020","crédito",3,416),
  (317,69081686183773784,508,"10/00/2008","25/35/2015","débito",2,57),
  (318,4114613157894783,277,"23/08/2008","03/37/2016","débito",3,56),
  (319,1610619967079396,819,"27/11/2006","05/54/2022","crédito",1,211),
  (320,97176739071504900,824,"06/40/2007","19/43/2012","crédito",2,86),
  (321,62510293306247580,755,"15/28/2006","21/09/2022","débito",1,251),
  (322,7320128475438961,564,"02/13/2008","13/01/2017","débito",1,365),
  (323,26992063815823836,504,"24/41/2003","30/47/2020","crédito",2,67),
  (324,95591288922275540,312,"09/32/2004","23/08/2014","crédito",3,57),
  (325,44471555570398720,228,"19/18/2006","09/21/2014","débito",2,381),
  (326,32769696966709744,104,"19/06/2002","19/46/2016","débito",1,334),
  (327,35167919163658110,448,"31/43/2007","07/19/2013","crédito",2,57),
  (328,74457726210081710,960,"03/17/2005","26/40/2022","crédito",2,136),
  (329,40886260789181670,599,"21/33/2006","10/27/2020","débito",2,313),
  (330,87288321889961800,425,"05/03/2005","26/00/2020","débito",1,233),
  (331,12538308691785200,139,"04/53/2003","29/13/2013","crédito",1,110),
  (332,27805608394884810,126,"02/21/2003","21/46/2023","crédito",2,160),
  (333,73438251223582260,418,"05/24/2009","18/28/2021","débito",2,326),
  (334,88431122916580690,941,"05/17/2004","05/56/2017","débito",3,2),
  (335,2927471556120633,352,"08/01/2002","08/16/2017","crédito",2,254),
  (336,88835210370627820,719,"18/53/2008","23/53/2020","crédito",2,231),
  (337,44211479091386610,131,"31/55/2010","08/49/2013","débito",1,314),
  (338,44985478815519950,341,"26/49/2010","06/05/2016","débito",2,264),
  (339,12343258759179896,491,"01/26/2005","11/17/2017","crédito",3,357),
  (340,3146817454464040,734,"07/37/2003","04/20/2012","crédito",1,433),
  (341,11128788683912552,577,"17/02/2010","27/05/2019","débito",1,427),
  (342,86535938088431760,938,"18/17/2006","14/53/2022","débito",1,247),
  (343,46720349117699520,634,"25/11/2005","25/45/2018","crédito",1,259),
  (344,90771404777013840,688,"23/28/2003","03/25/2013","crédito",1,428),
  (345,44445427223182460,218,"12/30/2004","06/58/2023","débito",1,193),
  (346,86492215150296660,494,"09/24/2007","07/59/2018","débito",3,266),
  (347,90762724690330540,889,"04/36/2006","28/05/2013","crédito",3,190),
  (348,55987308133862800,662,"08/52/2002","08/37/2016","crédito",2,266),
  (349,59125981509219090,326,"20/15/2004","15/44/2020","débito",1,148),
  (350,23526725397524244,605,"14/29/2009","14/13/2016","débito",2,109);

INSERT INTO "Tarjeta"
VALUES
  (351,36920869276665490,220,"23/04/2005","20/44/2018","crédito",2,139),
  (352,84987218932834580,828,"19/36/2004","20/17/2016","crédito",1,493),
  (353,25887295849338864,742,"25/00/2005","16/14/2022","débito",1,302),
  (354,39110265991916904,647,"25/45/2008","02/00/2016","débito",2,299),
  (355,80133538684938000,967,"28/48/2006","10/11/2014","crédito",3,177),
  (356,17673047742370548,937,"12/53/2000","25/13/2013","crédito",1,343),
  (357,61314744819019040,544,"29/47/2009","08/25/2019","débito",3,191),
  (358,48493813331919930,777,"16/26/2006","04/53/2022","débito",3,499),
  (359,50908683614146290,407,"28/41/2008","19/03/2013","crédito",2,56),
  (360,55027534511172184,920,"20/12/2010","20/54/2013","crédito",3,127),
  (361,65066546282836430,387,"20/34/2003","01/37/2013","débito",3,360),
  (362,95454946274625860,564,"20/23/2008","17/23/2020","débito",2,249),
  (363,76404231363494080,356,"17/28/2009","03/33/2014","crédito",2,50),
  (364,69998633871362920,376,"11/34/2008","23/25/2015","crédito",3,8),
  (365,11789846021136900,799,"16/53/2002","31/11/2018","débito",2,84),
  (366,93580932643023550,343,"13/52/2003","14/01/2019","débito",2,38),
  (367,44984038178859710,240,"01/28/2002","09/26/2019","crédito",1,24),
  (368,50889580159867380,142,"07/56/2009","11/02/2014","crédito",2,18),
  (369,83765214463166300,752,"09/35/2000","06/42/2013","débito",1,209),
  (370,47209989358603650,572,"16/58/2002","16/40/2020","débito",1,269),
  (371,34400300791355076,172,"30/16/2005","24/43/2016","crédito",2,433),
  (372,50902362514073520,466,"19/18/2006","23/55/2012","crédito",2,229),
  (373,75460522536959140,904,"31/52/2002","28/57/2019","débito",3,168),
  (374,30859941408094476,979,"18/15/2006","16/20/2017","débito",2,109),
  (375,96031689128543860,448,"23/01/2001","21/27/2013","crédito",2,484),
  (376,85552475263205340,454,"10/09/2006","01/42/2015","crédito",2,222),
  (377,33850207614503124,249,"09/56/2001","28/08/2021","débito",1,197),
  (378,28108357467918604,128,"29/32/2010","29/00/2023","débito",2,47),
  (379,404985782262852,593,"19/08/2002","10/31/2016","crédito",2,432),
  (380,73504673609010200,716,"14/47/2007","14/37/2019","crédito",2,73),
  (381,12435318380634544,184,"07/57/2010","23/19/2016","débito",2,219),
  (382,25628762562204988,799,"27/50/2000","20/58/2016","débito",2,180),
  (383,84436545545467440,163,"31/20/2011","12/00/2021","crédito",2,10),
  (384,63045857324984140,104,"17/23/2002","01/20/2022","crédito",3,41),
  (385,82353314432689150,714,"08/24/2007","08/09/2023","débito",3,272),
  (386,91114148228908270,975,"23/12/2004","27/42/2022","débito",3,498),
  (387,59996054435439990,213,"20/58/2007","12/51/2019","crédito",2,118),
  (388,68313200530978970,541,"10/35/2001","09/48/2016","crédito",3,415),
  (389,78602310889691260,780,"25/14/2003","24/58/2014","débito",2,134),
  (390,72523090104591280,375,"07/58/2006","26/37/2017","débito",3,226),
  (391,52535579100764060,236,"19/07/2011","15/32/2018","crédito",2,476),
  (392,29730886814554364,117,"11/56/2010","30/04/2018","crédito",2,359),
  (393,30523652843201676,754,"12/01/2007","22/14/2023","débito",3,271),
  (394,16470460138422812,999,"12/06/2002","17/02/2016","débito",3,275),
  (395,19413259533994610,123,"19/29/2010","18/20/2018","crédito",1,147),
  (396,80622646648590020,756,"12/39/2003","20/41/2019","crédito",2,360),
  (397,48557333317421864,303,"09/41/2004","15/21/2018","débito",3,94),
  (398,52243893689431096,996,"05/04/2008","26/52/2018","débito",2,443),
  (399,14170941029035740,270,"04/40/2005","27/55/2017","crédito",2,252),
  (400,63022640318007880,569,"26/54/2002","17/04/2017","crédito",3,99);

INSERT INTO "Tarjeta"
VALUES
  (401,81745859458251380,189,"03/48/2011","18/51/2013","débito",1,318),
  (402,72532207936703000,841,"02/50/2009","21/11/2021","débito",3,293),
  (403,17613535314051504,272,"10/55/2001","02/07/2018","crédito",1,17),
  (404,63266268265487460,123,"11/31/2007","09/54/2021","crédito",2,92),
  (405,92412180977218030,666,"22/33/2005","16/00/2015","débito",2,331),
  (406,58522369908965810,970,"03/10/2005","19/44/2019","débito",2,475),
  (407,8962201722689561,362,"30/21/2002","03/25/2015","crédito",1,78),
  (408,56366569561405270,901,"17/50/2006","07/46/2018","crédito",2,462),
  (409,28670436976629800,159,"08/07/2006","28/39/2018","débito",2,154),
  (410,46119461556597780,339,"15/15/2006","12/07/2022","débito",3,326),
  (411,59118659089018070,400,"30/19/2003","20/32/2013","crédito",2,111),
  (412,7901452816243676,130,"17/51/2009","08/44/2012","crédito",2,127),
  (413,44496027117548184,107,"20/19/2005","17/03/2012","débito",2,407),
  (414,91176765906092000,463,"21/53/2005","29/22/2013","débito",1,116),
  (415,26923759214890096,706,"06/33/2008","12/09/2014","crédito",2,153),
  (416,24158885961134388,869,"12/15/2011","21/01/2013","crédito",2,282),
  (417,40227828534495490,378,"04/23/2011","28/35/2016","débito",2,154),
  (418,42795218749099864,691,"19/06/2004","07/31/2015","débito",3,367),
  (419,31033231639070532,940,"09/56/2004","15/59/2018","crédito",2,95),
  (420,95914014642270420,724,"30/52/2003","21/24/2015","crédito",3,336),
  (421,25658065100225920,684,"10/53/2000","20/24/2014","débito",3,311),
  (422,68400542737439896,110,"08/07/2003","22/20/2023","débito",1,306),
  (423,13831439296665484,313,"05/18/2007","27/18/2019","crédito",2,3),
  (424,63532475193295160,359,"20/56/2010","10/50/2014","crédito",3,75),
  (425,89399018181173810,379,"19/15/2005","10/32/2012","débito",1,244),
  (426,92355960847961040,402,"05/26/2003","17/15/2015","débito",2,437),
  (427,23566970824308850,274,"13/09/2003","12/09/2020","crédito",1,321),
  (428,54728086829443280,338,"10/13/2005","14/25/2018","crédito",2,17),
  (429,35071789926030024,513,"24/32/2011","30/23/2014","débito",1,250),
  (430,11139130452861536,734,"09/20/2002","15/55/2016","débito",3,123),
  (431,22199593282315456,182,"21/32/2007","10/55/2020","crédito",3,426),
  (432,85028505184428740,609,"22/01/2010","16/20/2013","crédito",3,493),
  (433,47361360153517480,870,"25/08/2003","27/08/2013","débito",2,157),
  (434,97793894288587150,712,"07/02/2009","05/12/2015","débito",1,138),
  (435,43077597994132630,120,"23/43/2008","18/09/2014","crédito",3,144),
  (436,94998565758622420,568,"30/52/2010","22/52/2016","crédito",2,222),
  (437,75381652928009550,620,"14/37/2009","13/00/2013","débito",2,245),
  (438,55468900632293976,442,"22/27/2001","21/21/2020","débito",1,405),
  (439,22748775384256704,517,"05/54/2003","16/03/2016","crédito",2,324),
  (440,88056014963992850,268,"22/15/2003","27/36/2021","crédito",1,499),
  (441,96336398916531900,592,"13/40/2010","23/10/2015","débito",2,416),
  (442,50875785111119380,279,"21/12/2001","29/40/2016","débito",2,344),
  (443,70347289153855810,681,"08/43/2000","08/29/2016","crédito",1,31),
  (444,53134201270220890,773,"18/28/2003","25/53/2013","crédito",3,486),
  (445,13505684960864368,593,"23/46/2003","07/52/2017","débito",2,56),
  (446,82399478449340260,239,"29/39/2008","04/33/2021","débito",1,413),
  (447,73442558110917100,413,"21/02/2009","15/01/2019","crédito",2,52),
  (448,88681015634928370,610,"16/24/2010","05/10/2022","crédito",2,391),
  (449,27551922776289468,172,"20/56/2007","26/14/2018","débito",3,181),
  (450,48982747461289544,595,"17/39/2007","31/50/2021","débito",2,437);

INSERT INTO "Tarjeta"
VALUES
  (451,49861026185002350,927,"09/06/2010","13/19/2018","crédito",3,349),
  (452,1301944551679324,731,"15/22/2010","15/29/2018","crédito",1,159),
  (453,12750289005107904,860,"27/50/2010","16/32/2020","débito",1,30),
  (454,22008728751513236,221,"08/57/2003","21/50/2022","débito",1,356),
  (455,10585185555654504,260,"21/09/2005","29/18/2013","crédito",2,491),
  (456,2508485261212831,417,"01/08/2007","15/49/2013","crédito",1,291),
  (457,32147340878162364,848,"23/28/2006","26/46/2013","débito",2,85),
  (458,96753548144046190,794,"15/44/2007","26/14/2014","débito",2,460),
  (459,92258112999773760,534,"11/07/2008","06/06/2016","crédito",1,317),
  (460,50862456954904500,641,"30/40/2003","11/36/2021","crédito",1,187),
  (461,91187757310287040,371,"20/28/2008","09/03/2017","débito",2,94),
  (462,13416170919378768,842,"24/39/2004","18/23/2019","débito",1,334),
  (463,90161460591197500,643,"19/55/2005","19/55/2023","crédito",2,359),
  (464,39868018965399600,255,"18/40/2008","05/57/2013","crédito",1,332),
  (465,49258957227566150,364,"30/54/2001","18/30/2018","débito",2,261),
  (466,59685372182068800,697,"28/05/2006","10/21/2019","débito",1,276),
  (467,4156822068785384,470,"30/34/2003","20/10/2022","crédito",3,31),
  (468,12472886947674708,343,"14/39/2008","08/07/2014","crédito",2,460),
  (469,45902863650951890,599,"01/28/2008","18/03/2018","débito",3,272),
  (470,7703550101332006,497,"13/08/2005","25/27/2018","débito",1,363),
  (471,74450714300700020,468,"29/05/2003","31/07/2017","crédito",3,324),
  (472,93991614715857710,827,"18/17/2000","02/24/2014","crédito",3,241),
  (473,65584350792037170,309,"20/08/2009","06/13/2021","débito",2,376),
  (474,34002896184858988,320,"16/04/2011","03/29/2017","débito",3,398),
  (475,16323155643726404,900,"22/19/2008","28/29/2013","crédito",3,422),
  (476,59355861492656424,849,"19/47/2002","08/29/2015","crédito",1,327),
  (477,53679057449925510,680,"15/21/2005","01/44/2021","débito",1,383),
  (478,78767884571319260,985,"20/19/2001","27/58/2019","débito",1,488),
  (479,84660281124424300,241,"11/19/2006","20/14/2019","crédito",2,82),
  (480,29230277453613650,909,"03/27/2008","14/27/2017","crédito",1,45),
  (481,1875204983346773,707,"16/09/2009","08/28/2013","débito",3,364),
  (482,15503603861126480,380,"09/07/2011","07/13/2017","débito",2,322),
  (483,22464917248398396,135,"18/50/2003","20/26/2016","crédito",3,403),
  (484,65982115884332664,704,"20/21/2009","24/01/2014","crédito",2,401),
  (485,99090788021987440,496,"02/39/2008","11/43/2018","débito",2,321),
  (486,79555105853242980,903,"27/21/2001","07/04/2021","débito",1,256),
  (487,26106009631255056,324,"15/24/2005","23/06/2013","crédito",3,26),
  (488,81066773250199950,241,"06/39/2004","05/47/2020","crédito",3,215),
  (489,81922569549292220,614,"23/26/2010","27/37/2023","débito",2,12),
  (490,41417360020172420,325,"11/22/2006","08/04/2018","débito",2,161),
  (491,65404183536224850,134,"07/18/2003","13/37/2022","crédito",2,429),
  (492,8710216463223287,468,"23/39/2006","20/12/2016","crédito",2,401),
  (493,19770331034817068,209,"09/17/2004","22/45/2014","débito",3,412),
  (494,22516599834010660,677,"09/53/2005","11/00/2015","débito",2,268),
  (495,47754365739278880,884,"29/07/2010","11/38/2015","crédito",2,336),
  (496,19703111215762720,553,"02/26/2009","20/04/2016","crédito",2,95),
  (497,91825565355743060,948,"27/08/2004","18/03/2020","débito",1,477),
  (498,58352846235798776,913,"01/38/2007","18/18/2015","débito",1,394),
  (499,4505546038811107,989,"17/03/2004","29/55/2022","crédito",1,185),
  (500,57268799714800450,182,"31/29/2007","30/38/2020","crédito",1,481);
  
select * from "Tarjeta"


/*Ampliar el alcance de la entidad cuenta para que identifique el tipo de la misma*/

ALTER TABLE cuenta ADD "Tipo de cuenta" INTEGER REFERENCES "Tipo de cuenta"("id");
select * from cuenta

/*Asignar un tipo de cuenta a cada registro de cuenta de forma aleatoria*/

UPDATE cuenta 
SET "Tipo de cuenta"=((abs(random() % 3)))+1;

/*Corregir el campo employee_hire_date de la tabla empleado con la fecha en formato YYYY-MM-DD*/

update empleado set employee_hire_date = substr(employee_hire_date, 7) || "-" || substr(employee_hire_date,4,2) 
  || "-" || substr(employee_hire_date, 1,2);



/* SEGUNDA PROBLEMATICA */

/* Creo vista */

CREATE VIEW cliente_nuevo AS
SELECT
	customer_id AS id,
	branch_number AS "numero sucursal",
	customer_name AS nombre, 
	customer_surname AS apellido, 
	customer_DNI AS DNI, 
	(date() - dob) AS edad
FROM cliente
INNER JOIN sucursal ON sucursal.branch_id = cliente.branch_id;

/* Selecciono clientes de más de 40 y ordeno por DNI */

SELECT * FROM cliente_nuevo WHERE edad > 40 ORDER BY DNI;

/* Selecciono clientes con nombre igual a Anne o Tyler ordenados por edad */

SELECT * FROM cliente_nuevo WHERE nombre IN ("Anne", "Tyler") ORDER BY edad;

/* Inserto nuevos clientes */

INSERT INTO cliente (customer_name, customer_surname, customer_DNI, branch_id, dob) 
VALUES
	("Lois", "Stout", "47730534", 80, "1984-07-07"),
	("Hall", "Mcconnell", "52055464", 45, "1968-04-30"),
	("Hilel", "Mclean", "43625213", 77, "1993-03-28"),
	("Jin", "Cooley", "21207908", 96, "1959-08-24"),
	("Gabriel", "Harmon", "57063950", 27, "1976-04-01");
SELECT * FROM cliente;

/* Actualizo los clientes nuevos */

UPDATE cliente
SET branch_id = 10
WHERE customer_id IN (
	SELECT customer_id 
	FROM cliente 
	ORDER BY customer_id DESC
	LIMIT 5
);

/* Eliminar a Noel David */

DELETE FROM cliente WHERE customer_name = "Noel" AND customer_surname = "David";

/* Tipo de prestamo de mayor importe */

SELECT loan_type, MAX(loan_total) AS valor_maximo FROM prestamo;



/* TERCERA PROBLEMATICA */

/* Seleccionar cuentas con saldo negativo */

SELECT * FROM cuenta WHERE balance < 0;

/* Seleccionar nombre, apellido y edad de personas con apellido con Z */

SELECT customer_name, customer_surname, (date() - dob) AS edad FROM cliente WHERE customer_surname LIKE "%z%";

/* Seleccionar nombre, apellido, edad y nombre de sucursal de personas con nombre "Brendan" y 
ordenarlo por nombre de sucursal */

SELECT customer_name, customer_surname, (date() - dob) AS edad, branch_name 
FROM cliente
INNER JOIN sucursal ON sucursal. branch_id = cliente.branch_id
WHERE customer_name = "Brendan"
ORDER BY branch_name;

/* Seleccionar los préstamos con un importe mayor a $80.000 y los préstamos prendarios */

SELECT * FROM prestamo WHERE loan_total > 8000000
UNION 
SELECT * FROM prestamo WHERE loan_type = "PRENDARIO";

/* Seleccionar los prestamos cuyo importe sea mayor que el importe medio de todos los prestamos */

SELECT * FROM prestamo WHERE loan_total > (SELECT avg(loan_total) FROM prestamo);

/* Contar la cantidad de clientes menores a 50 años */

SELECT count(customer_id) AS cantidad_clientes FROM cliente WHERE (date() - dob) < 50;

/*  Seleccionar las primeras 5 cuentas con saldo mayor a 8.000$ */

SELECT * FROM cuenta 
WHERE balance > 800000
LIMIT 5;
select * from cuenta;

/* Seleccionar los préstamos que tengan fecha en abril, junio y agosto,
ordenándolos por importe */

SELECT * FROM prestamo 
WHERE strftime('%m', loan_date) IN ("08", "04", "06")
ORDER BY loan_total;

/* Importe total de los prestamos agrupados por tipo de préstamos */

SELECT loan_type, sum(loan_total) AS loan_total_accu FROM prestamo
GROUP BY loan_type;



/* CUARTA PROBLEMATICA */

/* Cantidad de clientes por nombre de sucursal ordenandos de mayor a menor */

SELECT
	branch_name, count(cliente.customer_id) AS cant_clientes
FROM sucursal
INNER JOIN cliente ON sucursal.branch_id = cliente.branch_id
GROUP BY branch_name
ORDER BY cant_clientes DESC;

/* Obtener la cantidad de empleados por cliente por sucursal en un número real */
/*SELECT
	*
FROM sucursal
INNER JOIN cliente ON cliente.branch_id = sucursal.branch_id
INNER JOIN empleado ON empleado.branch_id = sucursal.branch_id;*/

/* Obtener la cantidad de tarjetas de crédito por tipo por sucursal */

SELECT count(id) as "Tarjetas por sucursal","Tipo de tarjeta", branch_id FROM Tarjeta
INNER JOIN cliente ON cliente.customer_id = Tarjeta.Cliente
where "Tipo de tarjeta"="crédito"
group by branch_id;

/* Obtener el promedio de créditos otorgado por sucursal */

SELECT sucursal.branch_name, avg(prestamo.loan_total) AS sucursal_promedio FROM prestamo
INNER JOIN cliente ON prestamo.customer_id = cliente.customer_id
INNER JOIN sucursal ON sucursal.branch_id = cliente.branch_id
GROUP BY sucursal.branch_id;

/* La información de las cuentas resulta critica para la compañía, por eso es
necesario crear una tabla denominada “auditoria_cuenta” para guardar los
datos movimientos, con los siguientes campos: old_id, new_id, old_balance,
new_balance, old_iban, new_iban, old_type, new_type, user_action,
created_at
	o Crear un trigger que después de actualizar en la tabla cuentas los
	campos balance, IBAN o tipo de cuenta registre en la tabla auditoria
	o Restar $100 a las cuentas 10,11,12,13,14*/

CREATE TABLE auditoria_cuenta (
	auditoria_id INTEGER PRIMARY KEY AUTOINCREMENT,
	old_id INTEGER,
	new_id INTEGER,
	old_balance INTEGER,
	new_balance INTEGER,
	old_iban TEXT,
	new_iban TEXT,
	old_type INTEGER,
	new_type INTEGER,
	user_action TEXT,
	created_at TEXT NOT NULL
);


/*Creo trigger*/

CREATE TRIGGER tr_update_cuenta
BEFORE UPDATE ON cuenta
WHEN old.balance <> new.balance OR old.iban <> new.iban OR old.type <> new.type
BEGIN
	INSERT INTO auditoria_cuenta (auditoria_id, old_id, new_id, old_balance, new_balance,
		old_iban, new_iban, old_type, new_type, user_action, created_at)
	VALUES (old.account_id, new.account_id, old.balance, new.balance, old.iban, new.iban, old.type, new.type,
		"UPDATE", date());
END;


UPDATE cuenta
SET balance = balance - 100
WHERE account_id IN (10, 11, 12, 13, 14);

SELECT * FROM cuenta WHERE account_id IN (10, 11, 12, 13, 14);

/* Mediante índices mejorar la performance de la búsqueda de clientes por DNI */

CREATE INDEX index_dni 
ON cliente(customer_DNI);

/*  Crear la tabla “movimientos” con los campos de identificación del
movimiento, número de cuenta, monto, tipo de operación y hora
	o Mediante el uso de transacciones, hacer una transferencia de 1000$
	desde la cuenta 200 a la cuenta 400
	o Registrar el movimiento en la tabla movimientos
	o En caso de no poder realizar la operación de forma completa, realizar
	un ROLLBACK */

CREATE TABLE movimientos (
	movimiento_id INTEGER PRIMARY KEY AUTOINCREMENT,
	numero_cuenta INTEGER,
	monto INTEGER,
	tipo_operacion TEXT,
	hora TEXT
);


/*Transacción en archivo transaction.sql*/